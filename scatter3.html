<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>FinScore vs Bank Score Scatterplot (v4)</title>
<script src="d3.v7.min.js"></script>
<style>
    body {{
        font-family: "Helvetica Neue", Arial, sans-serif;
        background:#f5f5f5;
        margin:0;
        padding:20px;
        color:#333;
    }}
    h1 {{
        text-align:center;
        margin-bottom:10px;
    }}
    #chart-container {{
        display:flex;
        flex-direction:column;
        align-items:center;
    }}
    #controls {{
        margin:15px 0;
        display:flex;
        gap:20px;
        align-items:center;
    }}
    #metrics {{
        display:flex;
        gap:40px;
        flex-wrap:wrap;
        justify-content:center;
        margin-top:10px;
    }}
    .metric-box {{
        background:#fff;
        border-radius:8px;
        padding:10px 20px;
        box-shadow:0 2px 6px rgba(0,0,0,0.1);
        text-align:center;
        min-width:160px;
    }}
    .metric-box h3 {{
        margin:0 0 5px 0;
        font-size:0.9rem;
        color:#666;
    }}
    .metric-box span {{
        font-size:1.4rem;
        font-weight:bold;
    }}
    .legend {{
        display:flex;
        align-items:center;
        gap:8px;
        margin-top:10px;
    }}
    .legend svg {{
        overflow:visible;
    }}
    .legend text {{
        font-size:0.8rem;
        fill:#333;
    }}
</style>
</head>
<body>
<h1>FinScore Telco vs Bank Internal Score</h1>
<div id="chart-container">
    <svg id="scatter" width="800" height="600"></svg>
    <div id="controls">
        <label for="threshold">Combined&nbsp;Score&nbsp;≥&nbsp;<span id="thresh-val"></span></label>
        <input type="range" id="threshold" min="1" max="10" step="1" value="1">
        <button id="toggle">Play</button>
    </div>
    <div id="metrics">
        <div class="metric-box">
            <h3>Acceptance Rate</h3>
            <span id="acc-rate">0%</span>
        </div>
        <div class="metric-box">
            <h3>Default Rate</h3>
            <span id="def-rate">0%</span>
        </div>
        <div class="metric-box">
            <h3>Monetary benefit<br/>per application (PHP)</h3>
            <span id="benefit">₱0</span>
        </div>
    </div>
    <div class="legend" id="legend"></div>
</div>

<script>
/* ---------- Embedded aggregated data ---------- */
const data = [
  {
    "FinScore Telco": 1,
    "Bank Internal Score": 1,
    "Combined Score": 8,
    "good_bad_avg": 0.119,
    "count": 42
  },
  {
    "FinScore Telco": 1,
    "Bank Internal Score": 2,
    "Combined Score": 4,
    "good_bad_avg": 0.3534,
    "count": 116
  },
  {
    "FinScore Telco": 1,
    "Bank Internal Score": 3,
    "Combined Score": 3,
    "good_bad_avg": 0.3602,
    "count": 161
  },
  {
    "FinScore Telco": 1,
    "Bank Internal Score": 4,
    "Combined Score": 2,
    "good_bad_avg": 0.5205,
    "count": 146
  },
  {
    "FinScore Telco": 1,
    "Bank Internal Score": 5,
    "Combined Score": 2,
    "good_bad_avg": 0.527,
    "count": 148
  },
  {
    "FinScore Telco": 1,
    "Bank Internal Score": 6,
    "Combined Score": 2,
    "good_bad_avg": 0.4768,
    "count": 237
  },
  {
    "FinScore Telco": 1,
    "Bank Internal Score": 7,
    "Combined Score": 1,
    "good_bad_avg": 0.5538,
    "count": 251
  },
  {
    "FinScore Telco": 1,
    "Bank Internal Score": 8,
    "Combined Score": 1,
    "good_bad_avg": 0.5519,
    "count": 366
  },
  {
    "FinScore Telco": 1,
    "Bank Internal Score": 9,
    "Combined Score": 1,
    "good_bad_avg": 0.5747,
    "count": 348
  },
  {
    "FinScore Telco": 1,
    "Bank Internal Score": 10,
    "Combined Score": 1,
    "good_bad_avg": 0.6277,
    "count": 470
  },
  {
    "FinScore Telco": 2,
    "Bank Internal Score": 1,
    "Combined Score": 8,
    "good_bad_avg": 0.0909,
    "count": 66
  },
  {
    "FinScore Telco": 2,
    "Bank Internal Score": 2,
    "Combined Score": 5,
    "good_bad_avg": 0.2655,
    "count": 113
  },
  {
    "FinScore Telco": 2,
    "Bank Internal Score": 3,
    "Combined Score": 4,
    "good_bad_avg": 0.3709,
    "count": 151
  },
  {
    "FinScore Telco": 2,
    "Bank Internal Score": 4,
    "Combined Score": 3,
    "good_bad_avg": 0.4056,
    "count": 143
  },
  {
    "FinScore Telco": 2,
    "Bank Internal Score": 5,
    "Combined Score": 3,
    "good_bad_avg": 0.3929,
    "count": 168
  },
  {
    "FinScore Telco": 2,
    "Bank Internal Score": 6,
    "Combined Score": 3,
    "good_bad_avg": 0.3992,
    "count": 253
  },
  {
    "FinScore Telco": 2,
    "Bank Internal Score": 7,
    "Combined Score": 2,
    "good_bad_avg": 0.4582,
    "count": 275
  },
  {
    "FinScore Telco": 2,
    "Bank Internal Score": 8,
    "Combined Score": 2,
    "good_bad_avg": 0.4634,
    "count": 369
  },
  {
    "FinScore Telco": 2,
    "Bank Internal Score": 9,
    "Combined Score": 1,
    "good_bad_avg": 0.5238,
    "count": 378
  },
  {
    "FinScore Telco": 2,
    "Bank Internal Score": 10,
    "Combined Score": 1,
    "good_bad_avg": 0.5753,
    "count": 405
  },
  {
    "FinScore Telco": 3,
    "Bank Internal Score": 1,
    "Combined Score": 9,
    "good_bad_avg": 0.12,
    "count": 75
  },
  {
    "FinScore Telco": 3,
    "Bank Internal Score": 2,
    "Combined Score": 8,
    "good_bad_avg": 0.2703,
    "count": 111
  },
  {
    "FinScore Telco": 3,
    "Bank Internal Score": 3,
    "Combined Score": 5,
    "good_bad_avg": 0.3256,
    "count": 172
  },
  {
    "FinScore Telco": 3,
    "Bank Internal Score": 4,
    "Combined Score": 5,
    "good_bad_avg": 0.3488,
    "count": 172
  },
  {
    "FinScore Telco": 3,
    "Bank Internal Score": 5,
    "Combined Score": 4,
    "good_bad_avg": 0.3219,
    "count": 146
  },
  {
    "FinScore Telco": 3,
    "Bank Internal Score": 6,
    "Combined Score": 4,
    "good_bad_avg": 0.3756,
    "count": 213
  },
  {
    "FinScore Telco": 3,
    "Bank Internal Score": 7,
    "Combined Score": 3,
    "good_bad_avg": 0.4029,
    "count": 206
  },
  {
    "FinScore Telco": 3,
    "Bank Internal Score": 8,
    "Combined Score": 2,
    "good_bad_avg": 0.4958,
    "count": 361
  },
  {
    "FinScore Telco": 3,
    "Bank Internal Score": 9,
    "Combined Score": 2,
    "good_bad_avg": 0.5108,
    "count": 370
  },
  {
    "FinScore Telco": 3,
    "Bank Internal Score": 10,
    "Combined Score": 1,
    "good_bad_avg": 0.5415,
    "count": 386
  },
  {
    "FinScore Telco": 4,
    "Bank Internal Score": 1,
    "Combined Score": 10,
    "good_bad_avg": 0.1098,
    "count": 82
  },
  {
    "FinScore Telco": 4,
    "Bank Internal Score": 2,
    "Combined Score": 9,
    "good_bad_avg": 0.2301,
    "count": 113
  },
  {
    "FinScore Telco": 4,
    "Bank Internal Score": 3,
    "Combined Score": 8,
    "good_bad_avg": 0.2609,
    "count": 138
  },
  {
    "FinScore Telco": 4,
    "Bank Internal Score": 4,
    "Combined Score": 6,
    "good_bad_avg": 0.2313,
    "count": 160
  },
  {
    "FinScore Telco": 4,
    "Bank Internal Score": 5,
    "Combined Score": 5,
    "good_bad_avg": 0.331,
    "count": 145
  },
  {
    "FinScore Telco": 4,
    "Bank Internal Score": 6,
    "Combined Score": 5,
    "good_bad_avg": 0.3803,
    "count": 234
  },
  {
    "FinScore Telco": 4,
    "Bank Internal Score": 7,
    "Combined Score": 4,
    "good_bad_avg": 0.3962,
    "count": 260
  },
  {
    "FinScore Telco": 4,
    "Bank Internal Score": 8,
    "Combined Score": 3,
    "good_bad_avg": 0.4282,
    "count": 376
  },
  {
    "FinScore Telco": 4,
    "Bank Internal Score": 9,
    "Combined Score": 3,
    "good_bad_avg": 0.4531,
    "count": 384
  },
  {
    "FinScore Telco": 4,
    "Bank Internal Score": 10,
    "Combined Score": 2,
    "good_bad_avg": 0.5303,
    "count": 396
  },
  {
    "FinScore Telco": 5,
    "Bank Internal Score": 1,
    "Combined Score": 10,
    "good_bad_avg": 0.0652,
    "count": 92
  },
  {
    "FinScore Telco": 5,
    "Bank Internal Score": 2,
    "Combined Score": 9,
    "good_bad_avg": 0.1571,
    "count": 140
  },
  {
    "FinScore Telco": 5,
    "Bank Internal Score": 3,
    "Combined Score": 8,
    "good_bad_avg": 0.2294,
    "count": 170
  },
  {
    "FinScore Telco": 5,
    "Bank Internal Score": 4,
    "Combined Score": 7,
    "good_bad_avg": 0.3019,
    "count": 159
  },
  {
    "FinScore Telco": 5,
    "Bank Internal Score": 5,
    "Combined Score": 6,
    "good_bad_avg": 0.3448,
    "count": 145
  },
  {
    "FinScore Telco": 5,
    "Bank Internal Score": 6,
    "Combined Score": 5,
    "good_bad_avg": 0.3496,
    "count": 246
  },
  {
    "FinScore Telco": 5,
    "Bank Internal Score": 7,
    "Combined Score": 5,
    "good_bad_avg": 0.434,
    "count": 235
  },
  {
    "FinScore Telco": 5,
    "Bank Internal Score": 8,
    "Combined Score": 5,
    "good_bad_avg": 0.4078,
    "count": 309
  },
  {
    "FinScore Telco": 5,
    "Bank Internal Score": 9,
    "Combined Score": 4,
    "good_bad_avg": 0.4299,
    "count": 328
  },
  {
    "FinScore Telco": 5,
    "Bank Internal Score": 10,
    "Combined Score": 3,
    "good_bad_avg": 0.5164,
    "count": 366
  },
  {
    "FinScore Telco": 6,
    "Bank Internal Score": 1,
    "Combined Score": 10,
    "good_bad_avg": 0.0667,
    "count": 105
  },
  {
    "FinScore Telco": 6,
    "Bank Internal Score": 2,
    "Combined Score": 10,
    "good_bad_avg": 0.1575,
    "count": 146
  },
  {
    "FinScore Telco": 6,
    "Bank Internal Score": 3,
    "Combined Score": 9,
    "good_bad_avg": 0.2134,
    "count": 164
  },
  {
    "FinScore Telco": 6,
    "Bank Internal Score": 4,
    "Combined Score": 8,
    "good_bad_avg": 0.2455,
    "count": 167
  },
  {
    "FinScore Telco": 6,
    "Bank Internal Score": 5,
    "Combined Score": 7,
    "good_bad_avg": 0.3333,
    "count": 150
  },
  {
    "FinScore Telco": 6,
    "Bank Internal Score": 6,
    "Combined Score": 6,
    "good_bad_avg": 0.3137,
    "count": 271
  },
  {
    "FinScore Telco": 6,
    "Bank Internal Score": 7,
    "Combined Score": 6,
    "good_bad_avg": 0.307,
    "count": 228
  },
  {
    "FinScore Telco": 6,
    "Bank Internal Score": 8,
    "Combined Score": 6,
    "good_bad_avg": 0.3397,
    "count": 365
  },
  {
    "FinScore Telco": 6,
    "Bank Internal Score": 9,
    "Combined Score": 5,
    "good_bad_avg": 0.3576,
    "count": 330
  },
  {
    "FinScore Telco": 6,
    "Bank Internal Score": 10,
    "Combined Score": 3,
    "good_bad_avg": 0.4372,
    "count": 366
  },
  {
    "FinScore Telco": 7,
    "Bank Internal Score": 1,
    "Combined Score": 10,
    "good_bad_avg": 0.1058,
    "count": 104
  },
  {
    "FinScore Telco": 7,
    "Bank Internal Score": 2,
    "Combined Score": 10,
    "good_bad_avg": 0.1491,
    "count": 161
  },
  {
    "FinScore Telco": 7,
    "Bank Internal Score": 3,
    "Combined Score": 9,
    "good_bad_avg": 0.2429,
    "count": 140
  },
  {
    "FinScore Telco": 7,
    "Bank Internal Score": 4,
    "Combined Score": 8,
    "good_bad_avg": 0.205,
    "count": 161
  },
  {
    "FinScore Telco": 7,
    "Bank Internal Score": 5,
    "Combined Score": 7,
    "good_bad_avg": 0.3264,
    "count": 144
  },
  {
    "FinScore Telco": 7,
    "Bank Internal Score": 6,
    "Combined Score": 7,
    "good_bad_avg": 0.2377,
    "count": 244
  },
  {
    "FinScore Telco": 7,
    "Bank Internal Score": 7,
    "Combined Score": 7,
    "good_bad_avg": 0.3071,
    "count": 241
  },
  {
    "FinScore Telco": 7,
    "Bank Internal Score": 8,
    "Combined Score": 6,
    "good_bad_avg": 0.3031,
    "count": 353
  },
  {
    "FinScore Telco": 7,
    "Bank Internal Score": 9,
    "Combined Score": 6,
    "good_bad_avg": 0.3754,
    "count": 333
  },
  {
    "FinScore Telco": 7,
    "Bank Internal Score": 10,
    "Combined Score": 4,
    "good_bad_avg": 0.438,
    "count": 347
  },
  {
    "FinScore Telco": 8,
    "Bank Internal Score": 1,
    "Combined Score": 10,
    "good_bad_avg": 0.0687,
    "count": 131
  },
  {
    "FinScore Telco": 8,
    "Bank Internal Score": 2,
    "Combined Score": 10,
    "good_bad_avg": 0.1037,
    "count": 164
  },
  {
    "FinScore Telco": 8,
    "Bank Internal Score": 3,
    "Combined Score": 9,
    "good_bad_avg": 0.1732,
    "count": 179
  },
  {
    "FinScore Telco": 8,
    "Bank Internal Score": 4,
    "Combined Score": 9,
    "good_bad_avg": 0.2044,
    "count": 181
  },
  {
    "FinScore Telco": 8,
    "Bank Internal Score": 5,
    "Combined Score": 8,
    "good_bad_avg": 0.2321,
    "count": 168
  },
  {
    "FinScore Telco": 8,
    "Bank Internal Score": 6,
    "Combined Score": 7,
    "good_bad_avg": 0.304,
    "count": 227
  },
  {
    "FinScore Telco": 8,
    "Bank Internal Score": 7,
    "Combined Score": 7,
    "good_bad_avg": 0.2824,
    "count": 255
  },
  {
    "FinScore Telco": 8,
    "Bank Internal Score": 8,
    "Combined Score": 7,
    "good_bad_avg": 0.3292,
    "count": 325
  },
  {
    "FinScore Telco": 8,
    "Bank Internal Score": 9,
    "Combined Score": 6,
    "good_bad_avg": 0.3432,
    "count": 303
  },
  {
    "FinScore Telco": 8,
    "Bank Internal Score": 10,
    "Combined Score": 5,
    "good_bad_avg": 0.3899,
    "count": 377
  },
  {
    "FinScore Telco": 9,
    "Bank Internal Score": 1,
    "Combined Score": 10,
    "good_bad_avg": 0.0422,
    "count": 166
  },
  {
    "FinScore Telco": 9,
    "Bank Internal Score": 2,
    "Combined Score": 10,
    "good_bad_avg": 0.1081,
    "count": 148
  },
  {
    "FinScore Telco": 9,
    "Bank Internal Score": 3,
    "Combined Score": 10,
    "good_bad_avg": 0.2069,
    "count": 174
  },
  {
    "FinScore Telco": 9,
    "Bank Internal Score": 4,
    "Combined Score": 9,
    "good_bad_avg": 0.1444,
    "count": 187
  },
  {
    "FinScore Telco": 9,
    "Bank Internal Score": 5,
    "Combined Score": 9,
    "good_bad_avg": 0.2092,
    "count": 153
  },
  {
    "FinScore Telco": 9,
    "Bank Internal Score": 6,
    "Combined Score": 8,
    "good_bad_avg": 0.2612,
    "count": 245
  },
  {
    "FinScore Telco": 9,
    "Bank Internal Score": 7,
    "Combined Score": 8,
    "good_bad_avg": 0.2329,
    "count": 219
  },
  {
    "FinScore Telco": 9,
    "Bank Internal Score": 8,
    "Combined Score": 7,
    "good_bad_avg": 0.2632,
    "count": 304
  },
  {
    "FinScore Telco": 9,
    "Bank Internal Score": 9,
    "Combined Score": 7,
    "good_bad_avg": 0.295,
    "count": 339
  },
  {
    "FinScore Telco": 9,
    "Bank Internal Score": 10,
    "Combined Score": 6,
    "good_bad_avg": 0.3754,
    "count": 333
  },
  {
    "FinScore Telco": 10,
    "Bank Internal Score": 1,
    "Combined Score": 10,
    "good_bad_avg": 0.0349,
    "count": 172
  },
  {
    "FinScore Telco": 10,
    "Bank Internal Score": 2,
    "Combined Score": 10,
    "good_bad_avg": 0.0984,
    "count": 183
  },
  {
    "FinScore Telco": 10,
    "Bank Internal Score": 3,
    "Combined Score": 10,
    "good_bad_avg": 0.1657,
    "count": 175
  },
  {
    "FinScore Telco": 10,
    "Bank Internal Score": 4,
    "Combined Score": 9,
    "good_bad_avg": 0.1313,
    "count": 198
  },
  {
    "FinScore Telco": 10,
    "Bank Internal Score": 5,
    "Combined Score": 9,
    "good_bad_avg": 0.1463,
    "count": 164
  },
  {
    "FinScore Telco": 10,
    "Bank Internal Score": 6,
    "Combined Score": 9,
    "good_bad_avg": 0.1932,
    "count": 207
  },
  {
    "FinScore Telco": 10,
    "Bank Internal Score": 7,
    "Combined Score": 8,
    "good_bad_avg": 0.2,
    "count": 220
  },
  {
    "FinScore Telco": 10,
    "Bank Internal Score": 8,
    "Combined Score": 8,
    "good_bad_avg": 0.2367,
    "count": 245
  },
  {
    "FinScore Telco": 10,
    "Bank Internal Score": 9,
    "Combined Score": 8,
    "good_bad_avg": 0.2419,
    "count": 277
  },
  {
    "FinScore Telco": 10,
    "Bank Internal Score": 10,
    "Combined Score": 7,
    "good_bad_avg": 0.2861,
    "count": 339
  }
];

// SVG setup
const svg = d3.select("#scatter"),
      width = +svg.attr("width"),
      height = +svg.attr("height"),
      margin = {{top:40,right:40,bottom:60,left:60}};

// Scales
const x = d3.scaleLinear().domain([1,10]).range([margin.left, width - margin.right]),
      y = d3.scaleLinear().domain([1,10]).range([margin.top, height - margin.bottom]),

      color = d3.scaleThreshold()
        .domain([0.11,0.20,0.32,0.42,0.50])
        .range([
            "#9CCC65",
            "#D4E157",
            "#FFEE58",
            "#FFCA28",
            "#FFA726",
            "#FF7043"
        ]);

const radius = 10;

// Axes
svg.append("g")
    .attr("transform", `translate(0,${{height-margin.bottom}})`)
    .call(d3.axisBottom(x).ticks(10))
  .append("text")
    .attr("x", width/2).attr("y", 40)
    .attr("fill", "#000").attr("font-weight","bold")
    .attr("text-anchor","middle")
    .text("FinScore Telco (1 = low, 10 = high)");

svg.append("g")
    .attr("transform", `translate(${{margin.left}},0)`)
    .call(d3.axisLeft(y).ticks(10))
  .append("text")
    .attr("transform","rotate(-90)")
    .attr("x", -height/2).attr("y", -45)
    .attr("fill","#000").attr("text-anchor","middle")
    .attr("font-weight","bold")
    .text("Bank Internal Score (1 = best, 10 = worst)");

// Points
const gDots = svg.append("g");

gDots.selectAll("circle")
  .data(data)
  .join("circle")
    .attr("cx", d=>x(d["FinScore Telco"]))
    .attr("cy", d=>y(d["Bank Internal Score"]))
    .attr("r", radius)
    .attr("fill", d=>color(d.good_bad_avg))
    .attr("stroke","#333")
    .attr("stroke-width",0.6)
    .attr("opacity",0.9);

// Labels
gDots.selectAll("text")
  .data(data)
  .join("text")
    .attr("x", d=>x(d["FinScore Telco"]))
    .attr("y", d=>y(d["Bank Internal Score"]))
    .text(d=>d3.format(".0%")(d.good_bad_avg))
    .attr("font-size","0.6rem")
    .attr("font-weight","bold")
    .attr("text-anchor","middle")
    .attr("dy",".35em")
    .attr("pointer-events","none")
    .attr("fill","black");

// Tooltip
const tooltip = d3.select("body").append("div")
      .style("position","absolute")
      .style("pointer-events","none")
      .style("background","#fff")
      .style("border","1px solid #ccc")
      .style("padding","6px 10px")
      .style("border-radius","4px")
      .style("font-size","0.8rem")
      .style("opacity",0);

gDots.selectAll("circle")
  .on("mouseover", (event,d) => {{
      tooltip.style("opacity",1).html(
        `<strong>FinScore Telco:</strong> ${d["FinScore Telco"]}<br>
         <strong>Bank Score:</strong> ${d["Bank Internal Score"]}<br>
         <strong>Combined Score:</strong> ${d["Combined Score"]}<br>
         <strong>Avg Default:</strong> ${(d.good_bad_avg*100).toFixed(1)}%<br>
         <strong>Observations:</strong> ${d.count}`
      );
  }})
  .on("mousemove", event => tooltip.style("left",(event.pageX+10)+"px").style("top",(event.pageY-28)+"px"))
  .on("mouseout", () => tooltip.style("opacity",0));

// Legend
const legend = d3.select("#legend").html("");
const legendData = [
  ["0–10%", "#9CCC65"],
  ["11–19%", "#D4E157"],
  ["20–31%", "#FFEE58"],
  ["32–41%", "#FFCA28"],
  ["42–49%", "#FFA726"],
  ["50–100%", "#FF7043"]
];

const leg = legend.append("svg").attr("width",480).attr("height",32);

leg.selectAll("g")
  .data(legendData)
  .join("g")
    .attr("transform",(d,i)=>`translate(${i*80},0)`)
  .call(g => {{
      g.append("rect")
        .attr("x",0).attr("y",8).attr("width",14).attr("height",14)
        .attr("fill",d=>d[1])
        .attr("stroke","#333")
        .attr("stroke-width",0.3);
      g.append("text")
        .attr("x",18).attr("y",20)
        .attr("font-size","0.8rem")
        .text(d=>d[0]);
  }});

// Slider metrics
const slider = d3.select("#threshold");
const threshVal = d3.select("#thresh-val");
const accSpan = d3.select("#acc-rate");
const defSpan = d3.select("#def-rate");
const benSpan = d3.select("#benefit");
const totalObs = d3.sum(data, d=>d.count);

function updateMetrics(threshold) {{
    threshVal.text(threshold);
    const accepted = data.filter(d=>d["Combined Score"] >= threshold);
    const acceptedObs = d3.sum(accepted, d=>d.count);
    const acceptanceRate = acceptedObs / totalObs;
    const defaultNumerator = d3.sum(accepted, d=>d.count * d.good_bad_avg);
    const defaultRate = acceptedObs ? (defaultNumerator/acceptedObs) : 0;
    accSpan.text((acceptanceRate*100).toFixed(1)+"%");
    defSpan.text((defaultRate*100).toFixed(1)+"%");
    benSpan.text("₱"+(acceptanceRate*830).toFixed(0));
}}
slider.on("input", function(){{ updateMetrics(+this.value); }});
updateMetrics(+slider.node().value);

const button = d3.select("#toggle");
let interval = null;
button.on("click", () => {{
    if(interval) {{
        clearInterval(interval);
        interval = null;
        button.text("Play");
    }} else {{
        interval = setInterval(() => {{
            let v = +slider.node().value;
            v = v < 10 ? v + 1 : 1;
            slider.node().value = v;
            updateMetrics(v);
        }}, 1500);
        button.text("Pause");
    }}
}});
</script>
</body>
</html>
